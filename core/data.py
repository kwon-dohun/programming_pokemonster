# core/data.py
# í¬ì¼“ëª¬ ë¯¸ë‹ˆ ë°°í‹€ ê²Œì„ìš© ë°ì´í„°
# - íƒ€ì… ìƒì„±
# - í”Œë ˆì´ì–´ í¬ì¼“ëª¬
# - ìƒëŒ€ í¬ì¼“ëª¬ í’€
# - ì§„í™” ì •ë³´
# - íƒ€ì… ë„ê°
# - ì  í¬ì¼“ëª¬ ìƒì„±

import random

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# íƒ€ì… ìƒì„± (ê³µê²© â†’ ë°©ì–´)
# ë°°ìœ¨ë§Œ ì‚¬ìš© (ë‹¨ìˆœí™”)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

TYPE_EFFECTIVENESS = {
    "fire": {
        "grass": 2.0,
        "water": 0.5,
        "fire": 0.5
    },
    "water": {
        "fire": 2.0,
        "grass": 0.5,
        "water": 0.5
    },
    "grass": {
        "water": 2.0,
        "fire": 0.5,
        "grass": 0.5
    },
    "electric": {
        "water": 2.0,
        "grass": 0.5,
        "ground": 0.0
    },
    "ground": {
        "electric": 2.0,
        "fire": 2.0,
        "grass": 0.5
    },
    "flying": {
        "grass": 2.0,
        "electric": 0.5
    }
}


def get_type_multiplier(attacker, defender):
    return TYPE_EFFECTIVENESS.get(attacker, {}).get(defender, 1.0)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# í”Œë ˆì´ì–´ ì‹œì‘ í¬ì¼“ëª¬
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

STARTER_POKEMONS = [
    {
        "name": "í”¼ì¹´ì¸„",
        "type": "electric",
        "desc": "ë¹ ë¥¸ ìŠ¤í”¼ë“œì™€ ê°•ë ¥í•œ ì „ê¸° ê³µê²©ì´ íŠ¹ì§•ì¸ í¬ì¼“ëª¬",
        "hp": 35,
        "attack": 10,
        "level": 5,
        "exp": 0,
        "evolution": "ë¼ì´ì¸„",
        "evolve_level": 16
    },
    {
        "name": "íŒŒì´ë¦¬",
        "type": "fire",
        "desc": "ê³µê²©ë ¥ì´ ë†’ê³  í™”ì—¼ ê³µê²©ì— íŠ¹í™”ëœ ë¶ˆê½ƒ í¬ì¼“ëª¬",
        "hp": 39,
        "attack": 11,
        "level": 5,
        "exp": 0,
        "evolution": "ë¦¬ìë“œ",
        "evolve_level": 16
    },
    {
        "name": "ê¼¬ë¶€ê¸°",
        "type": "water",
        "desc": "ë†’ì€ ì²´ë ¥ê³¼ ì•ˆì •ì ì¸ ë°©ì–´ë ¥ì„ ê°€ì§„ ë¬¼ í¬ì¼“ëª¬",
        "hp": 44,
        "attack": 9,
        "level": 5,
        "exp": 0,
        "evolution": "ì–´ë‹ˆë¶€ê¸°",
        "evolve_level": 16
    },
    {
        "name": "ì´ìƒí•´ì”¨",
        "type": "grass",
        "desc": "ê· í˜• ì¡íŒ ëŠ¥ë ¥ì¹˜ì™€ íšŒë³µí˜• ì „íˆ¬ì— ìœ ë¦¬í•œ í’€ í¬ì¼“ëª¬",
        "hp": 45,
        "attack": 9,
        "level": 5,
        "exp": 0,
        "evolution": "ì´ìƒí•´í’€",
        "evolve_level": 16
    }
]

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì§„í™” ì •ë³´ (1ë‹¨ê³„ë§Œ)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

EVOLUTIONS = {
    "í”¼ì¹´ì¸„": {
        "evolve_to": "ë¼ì´ì¸„",
        "level": 10,
        "bonus_hp": 10,
        "bonus_atk": 5
    },
    "íŒŒì´ë¦¬": {
        "evolve_to": "ë¦¬ìë“œ",
        "level": 12,
        "bonus_hp": 10,
        "bonus_atk": 5
    },
    "ê¼¬ë¶€ê¸°": {
        "evolve_to": "ì–´ë‹ˆë¶€ê¸°",
        "level": 12,
        "bonus_hp": 10,
        "bonus_atk": 5
    },
    "ì´ìƒí•´ì”¨": {
        "evolve_to": "ì´ìƒí•´í’€",
        "level": 12,
        "bonus_hp": 10,
        "bonus_atk": 5
    }
}

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ìƒëŒ€ í¬ì¼“ëª¬ í’€
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ENEMY_POKEMONS = [
    # ë¶ˆ
    {"name": "íŒŒì´ë¦¬", "type": "fire", "hp": 30, "atk": 11},
    {"name": "ë¸Œì¼€ì¸", "type": "fire", "hp": 32, "atk": 10},
    {"name": "ë§ˆê·¸ë§ˆ", "type": "fire", "hp": 34, "atk": 12},

    # ë¬¼
    {"name": "ê¼¬ë¶€ê¸°", "type": "water", "hp": 38, "atk": 10},
    {"name": "ê³ ë¼íŒŒë•", "type": "water", "hp": 36, "atk": 11},
    {"name": "ì‰ì–´í‚¹", "type": "water", "hp": 28, "atk": 8},
    {"name": "ìˆ˜ëŒ•ì´", "type": "water", "hp": 40, "atk": 9},

    # í’€
    {"name": "ì´ìƒí•´ì”¨", "type": "grass", "hp": 40, "atk": 9},
    {"name": "ì¹˜ì½”ë¦¬íƒ€", "type": "grass", "hp": 42, "atk": 8},
    {"name": "ëª¨ë‹¤í”¼", "type": "grass", "hp": 35, "atk": 10},
    {"name": "ë¡œì ¤ë¦¬ì•„", "type": "grass", "hp": 37, "atk": 11},

    # ì „ê¸°
    {"name": "í”¼ì¹´ì¸„", "type": "electric", "hp": 33, "atk": 12},
    {"name": "ì½”ì¼", "type": "electric", "hp": 30, "atk": 11},
    {"name": "ì°Œë¦¬ë¦¬ê³µ", "type": "electric", "hp": 28, "atk": 13},

    # ë•…
    {"name": "ë””ê·¸ë‹¤", "type": "ground", "hp": 30, "atk": 12},
    {"name": "ê¼¬ë§ˆëŒ", "type": "ground", "hp": 45, "atk": 9},
    {"name": "ì½”ì½”íŒŒìŠ¤", "type": "ground", "hp": 48, "atk": 8},

    # ë¹„í–‰
    {"name": "êµ¬êµ¬", "type": "flying", "hp": 32, "atk": 10},
    {"name": "ì°Œë¥´ê¼¬", "type": "flying", "hp": 34, "atk": 11}
]

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# íƒ€ì… ë„ê° (ì„¤ëª…ìš©)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

TYPE_POKEDEX = {
    "fire": {
        "strong": ["grass"],
        "weak": ["water"],
        "neutral": ["fire"],
        "desc": "ë¶ˆê½ƒ íƒ€ì…ì€ ê³µê²©ë ¥ì´ ê°•í•˜ì§€ë§Œ ë¬¼ì— ì•½í•˜ë‹¤."
    },
    "water": {
        "strong": ["fire"],
        "weak": ["grass", "electric"],
        "neutral": ["water"],
        "desc": "ë¬¼ íƒ€ì…ì€ ì•ˆì •ì ì¸ íƒ€ì…ìœ¼ë¡œ ë¶ˆê½ƒì— ê°•í•˜ë‹¤."
    },
    "grass": {
        "strong": ["water"],
        "weak": ["fire", "flying"],
        "neutral": ["grass"],
        "desc": "í’€ íƒ€ì…ì€ íšŒë³µê³¼ ì§€ì†ì „ì— ìœ ë¦¬í•˜ì§€ë§Œ ë¶ˆê½ƒì— ì•½í•˜ë‹¤."
    },
    "electric": {
        "strong": ["water", "flying"],
        "weak": ["ground"],
        "neutral": ["electric", "grass"],
        "desc": "ì „ê¸° íƒ€ì…ì€ ë¹ ë¥´ì§€ë§Œ ë•… íƒ€ì…ì—ê²Œ ê³µê²©ì´ í†µí•˜ì§€ ì•ŠëŠ”ë‹¤."
    },
    "ground": {
        "strong": ["electric", "fire"],
        "weak": ["grass", "water"],
        "neutral": [],
        "desc": "ë•… íƒ€ì…ì€ ì „ê¸°ì— ë§¤ìš° ê°•í•˜ì§€ë§Œ ë¬¼ê³¼ í’€ì— ì•½í•˜ë‹¤."
    },
    "flying": {
        "strong": ["grass"],
        "weak": ["electric"],
        "neutral": [],
        "desc": "ë¹„í–‰ íƒ€ì…ì€ í’€ íƒ€ì…ì— ê°•í•˜ì§€ë§Œ ì „ê¸°ì— ì•½í•˜ë‹¤."
    }
}

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì  í¬ì¼“ëª¬ ìƒì„±
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

def get_random_enemy(player_level):
    from core.pokemon import Pokemon  # ğŸ”¹ ì´ ì¤„ ì¶”ê°€

    data = random.choice(ENEMY_POKEMONS).copy()

    level = max(1, player_level + random.choice([-1, 0, 1]))
    hp = data["hp"] + level * 2
    atk = data["atk"] + level

    return Pokemon(
        name=data["name"],
        ptype=data["type"],
        hp=hp,
        atk=atk,
        level=level,
        exp=0
    )

